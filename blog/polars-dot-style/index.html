<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Michael Chow">
<meta name="dcterms.date" content="2025-04-16">

<title>Great Tables: Becoming the Polars .style Property â€“ great_tables</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-afa37c5c79185640b9c231024f4fe5ea.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CN7Z82M6R7"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-CN7Z82M6R7', { 'anonymize_ip': true});
</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://cdn.jsdelivr.net/gh/posit-dev/supported-by-posit/js/badge.min.js" data-margin-left="28"></script>
<script async="" src="https://plausible.io/js/pa-N27-YgfNQBpdNqDqGcyE1.js"></script>
<script>
  window.plausible=window.plausible||function(){(plausible.q=plausible.q||[]).push(arguments)},plausible.init=plausible.init||function(i){plausible.o=i||{}};
  plausible.init()
</script>


<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="../../reference/_styles-quartodoc.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">great_tables</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../get-started/index.html"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../examples/index.html"> 
<span class="menu-text">Examples</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../reference/index.html"> 
<span class="menu-text">Reference</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/posit-dev/great-tables"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog/index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#how-we-got-there" id="toc-how-we-got-there" class="nav-link active" data-scroll-target="#how-we-got-there">How we got there</a>
  <ul class="collapse">
  <li><a href="#first-contact-polars-discord" id="toc-first-contact-polars-discord" class="nav-link" data-scroll-target="#first-contact-polars-discord">First contact: Polars discord</a></li>
  <li><a href="#jerry-wu-power-contributor" id="toc-jerry-wu-power-contributor" class="nav-link" data-scroll-target="#jerry-wu-power-contributor">Jerry Wu: power contributor</a></li>
  <li><a href="#growing-up-making-the-case-for-.style" id="toc-growing-up-making-the-case-for-.style" class="nav-link" data-scroll-target="#growing-up-making-the-case-for-.style">Growing up: making the case for <code>.style</code></a></li>
  </ul></li>
  <li><a href="#making-.style-work" id="toc-making-.style-work" class="nav-link" data-scroll-target="#making-.style-work">Making <code>.style</code> work</a>
  <ul class="collapse">
  <li><a href="#design-credibility" id="toc-design-credibility" class="nav-link" data-scroll-target="#design-credibility">Design credibility</a></li>
  <li><a href="#working-with-polars-selectors" id="toc-working-with-polars-selectors" class="nav-link" data-scroll-target="#working-with-polars-selectors">Working with Polars selectors</a></li>
  <li><a href="#technical-wiring-work" id="toc-technical-wiring-work" class="nav-link" data-scroll-target="#technical-wiring-work">Technical wiring work</a></li>
  </ul></li>
  <li><a href="#whats-next" id="toc-whats-next" class="nav-link" data-scroll-target="#whats-next">Whatâ€™s next?</a></li>
  <li><a href="#in-conclusion" id="toc-in-conclusion" class="nav-link" data-scroll-target="#in-conclusion">In conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Great Tables: Becoming the Polars <code>.style</code> Property</h1>
</div>



<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Michael Chow </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 16, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Roughly a year ago, the DataFrame library Polars made its v1.0.0 release. One neat feature included in the release was a <a href="https://docs.pola.rs/user-guide/misc/styling/"><code>DataFrame.style</code></a> propertyâ€”which returns a Great Tables object, so you can add things like titles, column labels, and highlighting for reporting.</p>
<p>When talking about the Polars integration, people are often surprised to hear it happened when Great Tables was only 8 months old. Moreover, the whole process of how open source maintainers chat and discuss teaming up can feel shrouded in mystery.</p>
<p>In this post, I want to take some time to discuss how folks in the Polars and Great Tables communities got to <code>DataFrame.style</code>. There are three big pieces:</p>
<ul>
<li><strong>How we got there</strong>: the magic of the Polars discord.</li>
<li><strong>Making <code>.style</code> work</strong>: enabling Great Tables to work as a property.</li>
<li><strong>Whatâ€™s next?</strong></li>
</ul>
<section id="how-we-got-there" class="level2">
<h2 class="anchored" data-anchor-id="how-we-got-there">How we got there</h2>
<section id="first-contact-polars-discord" class="level3">
<h3 class="anchored" data-anchor-id="first-contact-polars-discord">First contact: Polars discord</h3>
<p>Roughly a year ago, Rich Iannone and I (Michael Chow) started working together on Great Tablesâ€”a Python library for creating display tables. Initially, Great Tables only supported Pandas, but this made a few things difficult. For example, selecting columns and applying conditional styles took a surprising amount of code.</p>
<p>As an experiment, we added support for Polars, and wrote a post called <a href="../../blog/polars-styling/index.html">Great Tables: The Polars DataFrame Styler of Your Dreams</a>.</p>
<p>Curious in what folks thought, we dropped it in the Polars discord, and got some Great Feedback:</p>
<p><img src="discord-feedback.jpg" class="img-fluid" width="500"></p>
<p>But Ritchie Vink, the creator of Polars, knew we were harboring a shameful Pandas dependency secret:</p>
<p><img src="discord-why-pandas.jpg" class="img-fluid" width="500"></p>
<p>Itâ€™s true, we had baked Pandas in as a dependency. We were just kids back then when starting Great Tables. We didnâ€™t realize that the world was moving to DataFrame agnostic support ðŸ˜“.</p>
<p>But the more we used Polars with Great Tables, the happier we were. So we made some architectural tweaks to make Great Tables <a href="../../blog/bring-your-own-df/index.html">BYODF (Bring Your Own DataFrame)</a>. With these changes, Polars users could install and use Great Tables without pulling in an unnecessary dependency on another DataFrame library (Pandas).</p>
<p>These interactions were critical early on for co-designing Great Tables with Polars in mind. But the real magic for us was when Polars users started opening PRs on Great Tables, to make sure we got things right. Chief among them, Jerry Wu!</p>
</section>
<section id="jerry-wu-power-contributor" class="level3">
<h3 class="anchored" data-anchor-id="jerry-wu-power-contributor">Jerry Wu: power contributor</h3>
<p>Luckily, members of the Polars community, like Jerry Wu <a href="https://github.com/jrycw">(jrycw)</a>, showed up to make sure we wired up to Polars correctly, and to weigh in on how Polars should be used.</p>
<p>For example, Jerryâ€™s first PR was ensuring we handled a Polars deprecation correctly.</p>
<p><img src="pr-jerry.jpg" class="img-fluid"></p>
<p>I really canâ€™t overstate how much we appreciate his help, and how critical it has been in ensuring we get the details right.</p>
<p>In addition to his PRs, Jerry has done really Great Work sharing about table display. The most interesting example of this to me is that he discovered that Polars, Great Tables, and FastHTML work well together.</p>
<p><img src="linkedin-jerry.jpg" class="img-fluid" width="500"></p>
<p>Rich and I had no idea that was possible, and the FastHTML folks ended up adapting his example into an <a href="https://fastht.ml/gallery/split_view?category=visualizations&amp;project=great_tables_tables">entry on their gallery</a>. Jerry is constantly teaching us about what Great Tables can do.</p>
</section>
<section id="growing-up-making-the-case-for-.style" class="level3">
<h3 class="anchored" data-anchor-id="growing-up-making-the-case-for-.style">Growing up: making the case for <code>.style</code></h3>
<p>With so much joy coming out of the Polars integration, and support from folks in the Polars community, we started to wonder: how could Great Tables make Polars a first-class citizen?</p>
<p>This ultimately boiled down to asking: what would it take for the <code>polars.DataFrame.style</code> property to return a Great Tables object?</p>
<p>After some discussion on discord, the big pieces folks needed were some sense that Great Tables used a reasonable approach to table styling, carried few dependencies, and was engineered such that it could be returned from a <code>DataFrame.style</code> property. Ultimately, the next few months were spent getting Great Tables up to snuff, and the Polars PR merged.</p>
</section>
</section>
<section id="making-.style-work" class="level2">
<h2 class="anchored" data-anchor-id="making-.style-work">Making <code>.style</code> work</h2>
<p>The <a href="https://github.com/pola-rs/polars/pull/16809">PR to implement <code>.style</code> in Polars</a> went super quick, from advice on discord April to merged by June. A huge force behind the PR was <a href="https://github.com/MarcoGorelli">Marco Gorelli</a>, who encouraged us through the process!</p>
<p>In this section Iâ€™ll look at how we addressed the 3 big requirements behind making a strong case for <code>.DataFrame.style</code> returning a Great Tables object:</p>
<ul>
<li><strong>Design Credibility</strong>: Itâ€™s clear Great Tables is reasonably thought out.</li>
<li><strong>Working with Polars selectors</strong>: It integrates well with pieces like Polars selectors.</li>
<li><strong>Technical</strong>: Great Tables can be returned from a <code>DataFrame.style</code> property.</li>
</ul>
<section id="design-credibility" class="level3">
<h3 class="anchored" data-anchor-id="design-credibility">Design credibility</h3>
<p>Our biggest hurdle was that the Great Tables library was less than a year old. However, this youthful appearance is a bit misleading, because Great Tables builds on decades of table design and tooling. For example, Richâ€™s version of Great Tables in R, called <code>gt</code>, has been around since 2019 (see <a href="https://youtu.be/h1KAjSfSbmk">his rstudio::conf() talk</a>).</p>
<p>My favorite aspect of <code>gt</code> is that the community ran <strong>table contests</strong> every year. The contests donâ€™t even require the use of <code>gt</code> or Great Tables, just a zest for the art of table styling. The <a href="https://posit.co/blog/2024-table-contest-winners/">2024 Table Contest</a> had around <strong>60 submissions</strong>, and is something we often draw on for inspiration.</p>
<p>For more on the long history of table design, see <a href="https://posit-dev.github.io/great-tables/blog/design-philosophy/">The Design Philosophy of Great Tables</a>, or this <a href="https://hutchdatascience.org/better_tables/">Fred Hutch better tables workshop</a>.</p>
</section>
<section id="working-with-polars-selectors" class="level3">
<h3 class="anchored" data-anchor-id="working-with-polars-selectors">Working with Polars selectors</h3>
<p>One important task was <strong>sorting out how we use Polars selectors</strong>, to ensure they didnâ€™t break down the road.</p>
<p>For example, Great Tables allows Polars selectors to set styles on specific columns data. However, one challenge we ran into was figuring out what Polars considers an expression versus a selector. Essentially, selectors choose columns, but expressions represent operations on the data itself.</p>
<p>The code below shows cases where the <code>.exclude()</code> results in expressions or selectors.</p>
<div id="23f8f479" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars.selectors <span class="im">as</span> cs</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># selector: all columns except "a"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>cs.exclude(<span class="st">"a"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expression: same columns as above Â¯\_(ãƒ„)_/Â¯</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>cs.<span class="bu">all</span>().exclude(<span class="st">"a"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>After discussing with Polars folks <a href="https://github.com/pola-rs/polars/issues/16448">in this Polars issue</a>, we landed on <strong>4 rules for selectors</strong>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 46%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>rule</th>
<th>description</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>cs</code> functions</td>
<td>top-level <code>cs</code> selection functions -&gt; <strong>selector</strong></td>
<td><code>cs.starts_with("a")</code></td>
</tr>
<tr class="even">
<td>infix selectors</td>
<td>infix operators over all selectors -&gt; <strong>selector</strong></td>
<td><code>cs.starts_with("a") - cs.by_name("abc")</code></td>
</tr>
<tr class="odd">
<td>infix expressions</td>
<td>infix operators over any non-selectors -&gt; <strong>expression</strong></td>
<td><code>cs.starts_with("a") - "abc"</code></td>
</tr>
<tr class="even">
<td>method expressions</td>
<td>method calls off selectors -&gt; <strong>expression</strong></td>
<td><code>cs.all().exclude("a")</code></td>
</tr>
</tbody>
</table>
<p>Clarifying this was critical in Great Tables, because in some place we only accept selectors, so we needed to be able to articulate to users how to produce them.</p>
</section>
<section id="technical-wiring-work" class="level3">
<h3 class="anchored" data-anchor-id="technical-wiring-work">Technical wiring work</h3>
<p>The last hurdle was tweaking the <a href="../../reference/GT.html#great_tables.GT" title="0"><code>great_tables.GT</code></a> class to fit the flow of <code>DataFrame.style</code>. For example, here is what creating a <a href="../../reference/GT.html#great_tables.GT" title="0"><code>GT()</code></a> object looked like before and after <code>.style</code>:</p>
<ul>
<li>Before: <code>GT(my_data, id="my-table")</code></li>
<li>After: <code>my_data.style.with_id("my-table")</code></li>
</ul>
<p>Notice that before, the <code>GT(id=...)</code> argument could set the html id for a table. However, <code>DataFrame.style</code> is a property that canâ€™t take arguments, so we needed methods like <code>with_id()</code> to set these kinds of options.</p>
<p>Hereâ€™s a full code example, in case you want to see it in action.</p>
<div id="e1581fc6" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> exibble</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a GT object ----</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>GT(exibble, <span class="bu">id</span><span class="op">=</span><span class="st">"my-table"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create GT object via .style property ----</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>pl.DataFrame(exibble).style</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div id="keqcycbhcu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#keqcycbhcu table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#keqcycbhcu thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#keqcycbhcu p { margin: 0; padding: 0; }
 #keqcycbhcu .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #keqcycbhcu .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #keqcycbhcu .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #keqcycbhcu .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #keqcycbhcu .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #keqcycbhcu .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #keqcycbhcu .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #keqcycbhcu .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #keqcycbhcu .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #keqcycbhcu .gt_column_spanner_outer:first-child { padding-left: 0; }
 #keqcycbhcu .gt_column_spanner_outer:last-child { padding-right: 0; }
 #keqcycbhcu .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #keqcycbhcu .gt_spanner_row { border-bottom-style: hidden; }
 #keqcycbhcu .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #keqcycbhcu .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }
 #keqcycbhcu .gt_from_md> :first-child { margin-top: 0; }
 #keqcycbhcu .gt_from_md> :last-child { margin-bottom: 0; }
 #keqcycbhcu .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }
 #keqcycbhcu .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #keqcycbhcu .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #keqcycbhcu .gt_row_group_first td { border-top-width: 2px; }
 #keqcycbhcu .gt_row_group_first th { border-top-width: 2px; }
 #keqcycbhcu .gt_striped { color: #333333; background-color: #F4F4F4; }
 #keqcycbhcu .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #keqcycbhcu .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; }
 #keqcycbhcu .gt_first_grand_summary_row_bottom { border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; }
 #keqcycbhcu .gt_last_grand_summary_row_top { border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; }
 #keqcycbhcu .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #keqcycbhcu .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #keqcycbhcu .gt_left { text-align: left; }
 #keqcycbhcu .gt_center { text-align: center; }
 #keqcycbhcu .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #keqcycbhcu .gt_font_normal { font-weight: normal; }
 #keqcycbhcu .gt_font_bold { font-weight: bold; }
 #keqcycbhcu .gt_font_italic { font-style: italic; }
 #keqcycbhcu .gt_super { font-size: 65%; }
 #keqcycbhcu .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #keqcycbhcu .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>

<tr class="gt_col_headings">
  <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="num">num</th>
  <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="char">char</th>
  <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="fctr">fctr</th>
  <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="date">date</th>
  <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="time">time</th>
  <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="datetime">datetime</th>
  <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="currency">currency</th>
  <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="row">row</th>
  <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="group">group</th>
</tr>
</thead>
<tbody class="gt_table_body">
  <tr>
    <td class="gt_row gt_right">0.1111</td>
    <td class="gt_row gt_left">apricot</td>
    <td class="gt_row gt_left">one</td>
    <td class="gt_row gt_left">2015-01-15</td>
    <td class="gt_row gt_left">13:35</td>
    <td class="gt_row gt_left">2018-01-01 02:22</td>
    <td class="gt_row gt_right">49.95</td>
    <td class="gt_row gt_left">row_1</td>
    <td class="gt_row gt_left">grp_a</td>
  </tr>
  <tr>
    <td class="gt_row gt_right">2.222</td>
    <td class="gt_row gt_left">banana</td>
    <td class="gt_row gt_left">two</td>
    <td class="gt_row gt_left">2015-02-15</td>
    <td class="gt_row gt_left">14:40</td>
    <td class="gt_row gt_left">2018-02-02 14:33</td>
    <td class="gt_row gt_right">17.95</td>
    <td class="gt_row gt_left">row_2</td>
    <td class="gt_row gt_left">grp_a</td>
  </tr>
  <tr>
    <td class="gt_row gt_right">33.33</td>
    <td class="gt_row gt_left">coconut</td>
    <td class="gt_row gt_left">three</td>
    <td class="gt_row gt_left">2015-03-15</td>
    <td class="gt_row gt_left">15:45</td>
    <td class="gt_row gt_left">2018-03-03 03:44</td>
    <td class="gt_row gt_right">1.39</td>
    <td class="gt_row gt_left">row_3</td>
    <td class="gt_row gt_left">grp_a</td>
  </tr>
  <tr>
    <td class="gt_row gt_right">444.4</td>
    <td class="gt_row gt_left">durian</td>
    <td class="gt_row gt_left">four</td>
    <td class="gt_row gt_left">2015-04-15</td>
    <td class="gt_row gt_left">16:50</td>
    <td class="gt_row gt_left">2018-04-04 15:55</td>
    <td class="gt_row gt_right">65100.0</td>
    <td class="gt_row gt_left">row_4</td>
    <td class="gt_row gt_left">grp_a</td>
  </tr>
  <tr>
    <td class="gt_row gt_right">5550.0</td>
    <td class="gt_row gt_left">None</td>
    <td class="gt_row gt_left">five</td>
    <td class="gt_row gt_left">2015-05-15</td>
    <td class="gt_row gt_left">17:55</td>
    <td class="gt_row gt_left">2018-05-05 04:00</td>
    <td class="gt_row gt_right">1325.81</td>
    <td class="gt_row gt_left">row_5</td>
    <td class="gt_row gt_left">grp_b</td>
  </tr>
  <tr>
    <td class="gt_row gt_right">None</td>
    <td class="gt_row gt_left">fig</td>
    <td class="gt_row gt_left">six</td>
    <td class="gt_row gt_left">2015-06-15</td>
    <td class="gt_row gt_left">None</td>
    <td class="gt_row gt_left">2018-06-06 16:11</td>
    <td class="gt_row gt_right">13.255</td>
    <td class="gt_row gt_left">row_6</td>
    <td class="gt_row gt_left">grp_b</td>
  </tr>
  <tr>
    <td class="gt_row gt_right">777000.0</td>
    <td class="gt_row gt_left">grapefruit</td>
    <td class="gt_row gt_left">seven</td>
    <td class="gt_row gt_left">None</td>
    <td class="gt_row gt_left">19:10</td>
    <td class="gt_row gt_left">2018-07-07 05:22</td>
    <td class="gt_row gt_right">None</td>
    <td class="gt_row gt_left">row_7</td>
    <td class="gt_row gt_left">grp_b</td>
  </tr>
  <tr>
    <td class="gt_row gt_right">8880000.0</td>
    <td class="gt_row gt_left">honeydew</td>
    <td class="gt_row gt_left">eight</td>
    <td class="gt_row gt_left">2015-08-15</td>
    <td class="gt_row gt_left">20:20</td>
    <td class="gt_row gt_left">None</td>
    <td class="gt_row gt_right">0.44</td>
    <td class="gt_row gt_left">row_8</td>
    <td class="gt_row gt_left">grp_b</td>
  </tr>
</tbody>


</table>

</div>
        
</div>
</div>
<p>The <code>DataFrame.style</code> property is special, in that you donâ€™t pass any parameters to it. The motivation for this in Polars is that it matches the Pandas <code>pandas.DataFrame.style</code> approach, so provides a familiar interface for users coming from that package. It also matches the <code>DataFrame.plot</code> flow of both packages.</p>
<p>As it turns out, allowing every options settable in the <a href="../../reference/GT.html#great_tables.GT" title="0"><code>GT()</code></a> constructor to be set somewhere else was not something anticipated in the design of Great Tables. But after some light architectural wrestling, we introduced <code>.tab_stub()</code>, <code>.with_id()</code>, and <code>.with_locale()</code> to capture arguments you might pass to <a href="../../reference/GT.html#great_tables.GT" title="0"><code>GT()</code></a>.</p>
</section>
</section>
<section id="whats-next" class="level2">
<h2 class="anchored" data-anchor-id="whats-next">Whatâ€™s next?</h2>
<p>Currently, weâ€™re really excited about using Great Tables in different ways!</p>
<ul>
<li><a href="https://github.com/posit-dev/pointblank">Pointblank</a>: validate your DataFrames and database tables. Pointblank is quick to fire up and produces delightfully styled reports (using Great Tables ðŸ˜Ž).</li>
<li><a href="https://github.com/machow/reactable-py">reactable</a>: create interactive tables. We want to use reactable to render a Great Tables object interactively.</li>
</ul>
<p>Weâ€™re also focused on keeping bug fixes and features cooking in Great Tables. If thereâ€™s anything in particular youâ€™re looking for, definitely reach out on the <a href="https://github.com/posit-dev/great-tables/discussions">Great Tables discussion page</a>.</p>
</section>
<section id="in-conclusion" class="level2">
<h2 class="anchored" data-anchor-id="in-conclusion">In conclusion</h2>
<p>This post looked at how interacting with the Polars community discord shaped Great Tables development early on, and how community members like Jerry ended up ensuring Great Tables and Polars played well together. We ended up putting a ring on it, and ensuring Great Tables design, dependencies, and architecture worked well enough to justify returning via <code>polars.DataFrame.style</code>. (Though this is still marked unstable in Polars!)</p>
<p>Weâ€™re excited to look at different use cases for Great Tables (and table styling in general) over the next year!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/posit-dev\.github\.io\/great-tables\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>